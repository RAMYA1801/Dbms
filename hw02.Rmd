---
title: 'Homework #2'
subtitle: 'MATH 40024/50024: Computational Statistics'
date: "September 25, 2023"
output: pdf_document

fontfamily: mathpazo
fontsize: 11pt
header-includes:
   - \linespread{1.05}
urlcolor: blue
---

__20 points will be deducted if the submitted file is in wrong format.__ 

__Avoid plagiarism. You can discuss with other students, but you should complete the homework independently and the work should be in your own words. Copying text/code from students or other resources without proper referencing will result in ZERO marks.__

Please submit your answers as a __PDF__ file to Canvas before __the start of the class on October 5__. The PDF file should be generated by "knitting" the Rmd file. You may choose to first generate an HTML file (by changing the output format in the YAML to `output: html_document`) and then convert it to PDF. Word documents, however, cannot be used as an intermediate file (and of course, the submitted file). _Answer the questions with R code and include additional explanation when necessary._ Do not use `eval=FALSE`, `echo=FALSE` or `include=FALSE` as options in your code chunks. You may use the option `error=TRUE` for erroneous code. Do not remove any text or code from this document unless instructed. 

```{r, message=FALSE}
# Load the required packages
library(tidyverse)
library(nycflights13)
```

## Basic data transformation (25 points)

__1a.__ (5 points) Get all the flights with `"JFK"` as the origin airport in the month of September.
```{r}
library(tidyverse)
library(nycflights13)
flights |> 
    filter(origin=="JFK",month==9)

```

__1b.__ (10 points) Calculate the average arrival and departure delay for all flights with `"JFK"` as the origin airport in the month of September.
```{r}
?dplyr

flights |> 
    filter(origin=="JFK",month==9) |> 
    
    arr_delay


```


__1c.__ (10 points) Get the number of trips corresponding to each `origin` airport (`"JFK"`, `"LGA"`, `"EWR"`).

```{r}
if origin=="JFK"{
    PRINT('NUMBER OF FLIGHTA WITH ORIGIN JFK',count(flights)
}


```





```{r}
# Assuming your data frame is named flights_data with an 'origin' column
# Use the table function to count the number of trips for each origin
origin_counts <- table(flights$origin)

# Display the counts
print(origin_counts)
 
```


## Making sense of data (45 points)

__2a.__ Select all columns with a name that contains `"arr_"`. Create new variables `arr_hour` and `arr_min` for the arrival time in hours and minutes, and `sched_arr_hour` and `sched_arr_min` for the scheduled arrival time in hours and minutes. Save the result to a new `tibble`/`data.frame`, named `arrival`. `arrival` should have the same number of rows as in `flights`, and 7 columns. __Hint:__ Use `%/%` and `%%`. 

__2b.__ Calculate the departure delay using `arr_hour`, `arr_min`, `sched_arr_hour` and `sched_arr_min` in `arrival`, and add a new variable `arr_delay2` to store the result. `arr_delay2` should be equal to `arr_delay` in most (if not all) cases. Explain the remaining discrepancy in your result. __Hint:__ Use `filter()` to verify your answer. You may also want to use `relocate()` to ease comparison.

__2c.__ Get flights that arrived in 2014. Explain your reasoning.

## Data transformation and visualization (30 points)

__3a.__ Get the total number of trips for each `origin`, `dest` pair for `carrier` code `"AA"`. Add a new variable `route` to represent each `origin`/`dest` pair (e.g., `"LGA to STL"`) and summarize the result as a bar chart showing the total number of trips (in x-axis) for each route (in y-axis). __Hint:__ Use `paste()`.

__3b.__ Calculate the average speed flown (in MPH) and the average distance flown for each `origin`, `dest` pair. Excluding those pairs with average distance over 3,000 miles, in one scatterplot summarize the the average speed (in y-axis) versus the average distance (in x-axis). Use different colors to distinguish the three `origin` airports and add a smooth line with matched color for points corresponding to each `origin` airport.

